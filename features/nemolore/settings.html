<div id="nemolore_settings" class="inline-drawer">
    <div class="inline-drawer-toggle inline-drawer-header">
        <b>NemoLore Memory Management</b>
        <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
    </div>
    <div class="inline-drawer-content">
        
        <!-- Main Settings Section -->
        <div class="nemolore-settings-section">
            <h4>üß† Core Settings</h4>
            
            <!-- Enable Extension -->
            <div class="checkbox_label_div">
                <input type="checkbox" id="nemolore_enabled" name="nemolore_enabled">
                <label for="nemolore_enabled">Enable NemoLore Memory Management</label>
            </div>
            
            <!-- Enable Summarization -->
            <div class="checkbox_label_div">
                <input type="checkbox" id="nemolore_enableSummarization" name="nemolore_enableSummarization">
                <label for="nemolore_enableSummarization">Enable Smart Summarization</label>
            </div>
            
            <!-- Enable Paired Summarization -->
            <div class="checkbox_label_div">
                <input type="checkbox" id="nemolore_enablePairedSummarization" name="nemolore_enablePairedSummarization">
                <label for="nemolore_enablePairedSummarization">Enable Paired Summarization (v1.1.7)</label>
            </div>
            
            <!-- Hide Messages When Threshold -->
            <div class="checkbox_label_div">
                <input type="checkbox" id="nemolore_hideMessagesWhenThreshold" name="nemolore_hideMessagesWhenThreshold">
                <label for="nemolore_hideMessagesWhenThreshold">Hide Old Messages After Summarization</label>
            </div>
            
            <!-- Running Memory Size -->
            <div class="range_block">
                <label for="nemolore_runningMemorySize">Running Memory Size (recent messages to keep visible):</label>
                <input type="range" id="nemolore_runningMemorySize" name="nemolore_runningMemorySize" min="10" max="200" step="5" value="50">
                <span id="nemolore_runningMemorySize_output">50</span>
            </div>
            
            <!-- Link Summaries to AI -->
            <div class="checkbox_label_div">
                <input type="checkbox" id="nemolore_linkSummariesToAI" name="nemolore_linkSummariesToAI">
                <label for="nemolore_linkSummariesToAI">Link Summaries to AI Messages</label>
            </div>
            
            <!-- Summary Max Length -->
            <div class="range_block">
                <label for="nemolore_summaryMaxLength">Maximum Summary Length:</label>
                <input type="range" id="nemolore_summaryMaxLength" name="nemolore_summaryMaxLength" min="50" max="500" step="25" value="200">
                <span id="nemolore_summaryMaxLength_output">200</span>
            </div>
        </div>

        <!-- Vector Search Section -->
        <div class="nemolore-settings-section">
            <h4>üîç Vector Search & Memory</h4>
            
            <!-- Enable Vectorization -->
            <div class="checkbox_label_div">
                <input type="checkbox" id="nemolore_enableVectorization" name="nemolore_enableVectorization">
                <label for="nemolore_enableVectorization">Enable Semantic Search</label>
            </div>
            
            <!-- Vector Search Limit -->
            <div class="range_block">
                <label for="nemolore_vectorSearchLimit">Vector Search Results to Inject:</label>
                <input type="range" id="nemolore_vectorSearchLimit" name="nemolore_vectorSearchLimit" min="1" max="10" step="1" value="3">
                <span id="nemolore_vectorSearchLimit_output">3</span>
            </div>
        </div>

        <!-- Core Memory Section -->
        <div class="nemolore-settings-section">
            <h4>üåü Core Memory System</h4>
            
            <!-- Enable Core Memory Detection -->
            <div class="checkbox_label_div">
                <input type="checkbox" id="nemolore_enableCoreMemoryDetection" name="nemolore_enableCoreMemoryDetection">
                <label for="nemolore_enableCoreMemoryDetection">Enable Core Memory Detection</label>
            </div>
            
            <!-- Enable Core Memories -->
            <div class="checkbox_label_div">
                <input type="checkbox" id="nemolore_enableCoreMemories" name="nemolore_enableCoreMemories">
                <label for="nemolore_enableCoreMemories">Enable Core Memory System</label>
            </div>
            
            <!-- Core Memory Prompt Lorebook -->
            <div class="checkbox_label_div">
                <input type="checkbox" id="nemolore_coreMemoryPromptLorebook" name="nemolore_coreMemoryPromptLorebook">
                <label for="nemolore_coreMemoryPromptLorebook">Add Core Memories to Lorebook</label>
            </div>
        </div>

        <!-- Highlighting Section -->
        <div class="nemolore-settings-section">
            <h4>‚ú® Noun Highlighting</h4>
            
            <!-- Enable Highlighting -->
            <div class="checkbox_label_div">
                <input type="checkbox" id="nemolore_enableHighlighting" name="nemolore_enableHighlighting">
                <label for="nemolore_enableHighlighting">Enable Noun Highlighting</label>
            </div>
            
            <!-- Highlight Nouns -->
            <div class="checkbox_label_div">
                <input type="checkbox" id="nemolore_highlightNouns" name="nemolore_highlightNouns">
                <label for="nemolore_highlightNouns">Highlight Important Nouns</label>
            </div>
        </div>

        <!-- Auto-Lorebook Section -->
        <div class="nemolore-settings-section">
            <h4>üìö Auto-Lorebook</h4>
            
            <!-- Enable Auto-Lorebook -->
            <div class="checkbox_label_div">
                <input type="checkbox" id="nemolore_enableAutoLorebook" name="nemolore_enableAutoLorebook">
                <label for="nemolore_enableAutoLorebook">Enable Auto-Lorebook Generation</label>
            </div>

            <!-- Lorebook Generation Preset -->
            <div class="range_block">
                <label for="nemolore_generationPreset">Lorebook Generation Preset:</label>
                <select id="nemolore_generationPreset" name="nemolore_generationPreset" class="text_pole"></select>
            </div>
        </div>

        <!-- Advanced Settings -->
        <div class="nemolore-settings-section">
            <h4>‚öôÔ∏è Advanced Settings</h4>
            
            <!-- Debug Mode -->
            <div class="checkbox_label_div">
                <input type="checkbox" id="nemolore_debugMode" name="nemolore_debugMode">
                <label for="nemolore_debugMode">Enable Debug Mode</label>
            </div>
            
            <!-- Max Context Size -->
            <div class="range_block">
                <label for="nemolore_maxContextSize">Max Context Size:</label>
                <input type="range" id="nemolore_maxContextSize" name="nemolore_maxContextSize" min="1000" max="32000" step="1000" value="4000">
                <span id="nemolore_maxContextSize_output">4000</span>
            </div>
            
            <!-- Summary Threshold -->
            <div class="range_block">
                <label for="nemolore_summaryThreshold">Summary Threshold:</label>
                <input type="range" id="nemolore_summaryThreshold" name="nemolore_summaryThreshold" min="500" max="8000" step="500" value="2000">
                <span id="nemolore_summaryThreshold_output">2000</span>
            </div>
            
            <!-- Update Interval -->
            <div class="range_block">
                <label for="nemolore_updateInterval">Update Interval (seconds):</label>
                <input type="range" id="nemolore_updateInterval" name="nemolore_updateInterval" min="1" max="30" step="1" value="5">
                <span id="nemolore_updateInterval_output">5</span>
            </div>
            
            <!-- Notification Timeout -->
            <div class="range_block">
                <label for="nemolore_notificationTimeout">Notification Timeout (ms):</label>
                <input type="range" id="nemolore_notificationTimeout" name="nemolore_notificationTimeout" min="1000" max="15000" step="1000" value="5000">
                <span id="nemolore_notificationTimeout_output">5000</span>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="nemolore-settings-section">
            <h4>üéØ Actions</h4>
            
            <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px;">
                <button id="nemolore_view_summaries" class="menu_button" type="button">
                    <i class="fa-solid fa-eye"></i> View Summaries
                </button>
                <button id="nemolore_export_summaries" class="menu_button" type="button">
                    <i class="fa-solid fa-download"></i> Export Summaries
                </button>
                <button id="nemolore_system_check" class="menu_button" type="button">
                    <i class="fa-solid fa-stethoscope"></i> System Check
                </button>
            </div>
            
            <!-- Fallback buttons with different IDs for compatibility -->
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button id="nemolore_view_summaries_fallback" class="menu_button" type="button" style="display: none;">
                    <i class="fa-solid fa-eye"></i> View (Fallback)
                </button>
                <button id="nemolore_export_summaries_fallback" class="menu_button" type="button" style="display: none;">
                    <i class="fa-solid fa-download"></i> Export (Fallback)
                </button>
                <button id="nemolore_system_check_fallback" class="menu_button" type="button" style="display: none;">
                    <i class="fa-solid fa-stethoscope"></i> Check (Fallback)
                </button>
            </div>
        </div>

        <!-- Status Display -->
        <div class="nemolore-settings-section">
            <h4>üìä Status</h4>
            <div id="nemolore_status_display" style="font-family: monospace; font-size: 12px; background: #f5f5f5; padding: 10px; border-radius: 5px; margin-top: 10px;">
                NemoLore Status: Loading...
            </div>
        </div>

    </div>
</div>

<style>
.nemolore-settings-section {
    margin-bottom: 20px;
    padding: 15px;
    border: 1px solid #ddd;
    border-radius: 8px;
    background-color: #f9f9f9;
}

.nemolore-settings-section h4 {
    margin: 0 0 15px 0;
    color: #333;
    font-weight: bold;
}

.checkbox_label_div {
    margin-bottom: 10px;
}

.range_block {
    margin-bottom: 15px;
}

.range_block label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
}

.range_block input[type="range"] {
    width: 80%;
    margin-right: 10px;
}

.range_block span {
    font-weight: bold;
    color: #007cba;
}

#nemolore_status_display {
    max-height: 200px;
    overflow-y: auto;
}
</style>